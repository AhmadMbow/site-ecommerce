{% extends "adminpanel/base_admin.html" %}
{% load static %}
{% block title %}Admin | Gestion des Livreurs{% endblock %}
{% block header %}Gestion des Livreurs{% endblock %}

{% block extra_css %}
<style>
  :root {
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --success-gradient: linear-gradient(135deg, #10b981 0%, #059669 100%);
    --warning-gradient: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    --danger-gradient: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    --info-gradient: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    --card-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    --card-shadow-hover: 0 8px 32px rgba(102, 126, 234, 0.2);
    --radius: 1rem;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  body {
    background: linear-gradient(135deg, rgba(102,126,234,0.02), rgba(118,75,162,0.02));
  }

  /* Header Ultra-Premium */
  .deliverers-header {
    background: white;
    padding: 2rem;
    border-radius: var(--radius);
    box-shadow: var(--card-shadow);
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
  }

  .deliverers-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: var(--primary-gradient);
  }

  .deliverers-header::after {
    content: '';
    position: absolute;
    top: -50%;
    right: -10%;
    width: 300px;
    height: 300px;
    background: radial-gradient(circle, rgba(102,126,234,0.1), transparent);
    border-radius: 50%;
    animation: float 15s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translate(0, 0) rotate(0deg); }
    50% { transform: translate(-30px, -30px) rotate(180deg); }
  }

  .deliverers-title {
    font-size: 2rem;
    font-weight: 800;
    background: var(--primary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .deliverers-subtitle {
    color: #64748b;
    font-size: 1rem;
    margin: 0;
  }

  /* Stats Cards */
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  .stat-card-deliverer {
    background: white;
    padding: 1.5rem;
    border-radius: var(--radius);
    box-shadow: var(--card-shadow);
    transition: var(--transition);
    position: relative;
    overflow: hidden;
    cursor: pointer;
  }

  .stat-card-deliverer::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 5px;
    height: 100%;
    background: var(--primary-gradient);
    transition: width 0.3s ease;
  }

  .stat-card-deliverer:hover {
    transform: translateY(-5px);
    box-shadow: var(--card-shadow-hover);
  }

  .stat-card-deliverer:hover::before {
    width: 100%;
    opacity: 0.05;
  }

  .stat-icon-wrapper {
    width: 60px;
    height: 60px;
    border-radius: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.75rem;
    margin-bottom: 1rem;
  }

  .stat-icon-wrapper.primary {
    background: linear-gradient(135deg, rgba(102,126,234,0.15), rgba(118,75,162,0.15));
    color: #667eea;
  }

  .stat-icon-wrapper.success {
    background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(5,150,105,0.15));
    color: #10b981;
  }

  .stat-icon-wrapper.warning {
    background: linear-gradient(135deg, rgba(245,158,11,0.15), rgba(217,119,6,0.15));
    color: #f59e0b;
  }

  .stat-icon-wrapper.danger {
    background: linear-gradient(135deg, rgba(239,68,68,0.15), rgba(220,38,38,0.15));
    color: #ef4444;
  }

  .stat-label {
    color: #64748b;
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.5rem;
  }

  .stat-value {
    font-size: 2rem;
    font-weight: 800;
    color: #1a1f26;
    margin-bottom: 0.5rem;
  }

  .stat-change {
    font-size: 0.875rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  .stat-change.positive {
    color: #10b981;
  }

  .stat-change.negative {
    color: #ef4444;
  }

  /* Action Bar */
  .action-bar {
    background: white;
    padding: 1.5rem;
    border-radius: var(--radius);
    box-shadow: var(--card-shadow);
    margin-bottom: 2rem;
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
  }

  .search-wrapper {
    position: relative;
    flex: 1;
    min-width: 300px;
  }

  .search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: #94a3b8;
    pointer-events: none;
  }

  .search-input-ultra {
    width: 100%;
    padding: 0.875rem 1rem 0.875rem 3rem;
    border: 2px solid #e2e8f0;
    border-radius: 0.75rem;
    font-size: 0.95rem;
    transition: var(--transition);
    background: white;
  }

  .search-input-ultra:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
  }

  .btn-search {
    background: var(--primary-gradient);
    color: white;
    border: none;
    padding: 0.875rem 1.75rem;
    border-radius: 0.75rem;
    font-weight: 600;
    transition: var(--transition);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-search:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
  }

  .btn-add-deliverer {
    background: var(--success-gradient);
    color: white;
    border: none;
    padding: 0.875rem 1.75rem;
    border-radius: 0.75rem;
    font-weight: 600;
    transition: var(--transition);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    text-decoration: none;
  }

  .btn-add-deliverer:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    color: white;
  }

  /* Table Ultra-Premium */
  .table-card {
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--card-shadow);
    overflow: hidden;
  }

  .table-header {
    padding: 1.5rem;
    border-bottom: 2px solid #f1f5f9;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .table-header h5 {
    margin: 0;
    font-weight: 700;
    color: #1a1f26;
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .table-ultra-premium {
    width: 100%;
    margin: 0;
  }

  .table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    border-radius: 0 0 var(--radius) var(--radius);
  }

  .table-ultra-premium thead {
    background: linear-gradient(135deg, rgba(102,126,234,0.05), rgba(118,75,162,0.05));
  }

  .table-ultra-premium thead th {
    padding: 1rem 1.5rem;
    font-weight: 700;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #475569;
    border: none;
  }

  .table-ultra-premium tbody tr {
    border-bottom: 1px solid #f1f5f9;
    transition: var(--transition);
  }

  .table-ultra-premium tbody tr:hover {
    background: linear-gradient(135deg, rgba(102,126,234,0.02), rgba(118,75,162,0.02));
    transform: scale(1.01);
  }

  .table-ultra-premium tbody td {
    padding: 1.25rem 1.5rem;
    vertical-align: middle;
    border: none;
  }

  /* Deliverer Card */
  .deliverer-info {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .deliverer-avatar {
    width: 56px;
    height: 56px;
    border-radius: 1rem;
    object-fit: cover;
    border: 3px solid #fff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transition: var(--transition);
  }

  .deliverer-avatar:hover {
    transform: scale(1.1) rotate(5deg);
  }

  .deliverer-details {
    display: flex;
    flex-direction: column;
  }

  .deliverer-name {
    font-weight: 700;
    color: #1a1f26;
    font-size: 1rem;
    margin-bottom: 0.25rem;
  }

  .deliverer-username {
    color: #64748b;
    font-size: 0.875rem;
  }

  /* Contact Badges */
  .contact-info {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .contact-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: linear-gradient(135deg, rgba(102,126,234,0.05), rgba(118,75,162,0.05));
    border-radius: 0.5rem;
    color: #667eea;
    font-size: 0.875rem;
    font-weight: 600;
    text-decoration: none;
    transition: var(--transition);
  }

  .contact-badge:hover {
    background: linear-gradient(135deg, rgba(102,126,234,0.15), rgba(118,75,162,0.15));
    transform: translateX(5px);
  }

  .contact-badge.phone {
    background: linear-gradient(135deg, rgba(16,185,129,0.05), rgba(5,150,105,0.05));
    color: #10b981;
  }

  .contact-badge.phone:hover {
    background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(5,150,105,0.15));
  }

  /* Status Badges */
  .status-badge-ultra {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 700;
    font-size: 0.875rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .status-badge-ultra.active {
    background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(5,150,105,0.15));
    color: #059669;
  }

  .status-badge-ultra.inactive {
    background: linear-gradient(135deg, rgba(239,68,68,0.15), rgba(220,38,38,0.15));
    color: #dc2626;
  }

  /* Performance Badge */
  .performance-badge {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 700;
    font-size: 0.875rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: linear-gradient(135deg, rgba(245,158,11,0.15), rgba(217,119,6,0.15));
    color: #f59e0b;
  }

  /* Action Buttons */
  .action-buttons {
    display: flex;
    gap: 0.5rem;
  }

  .btn-action {
    width: 40px;
    height: 40px;
    border-radius: 0.75rem;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
    cursor: pointer;
    font-size: 1rem;
  }

  .btn-action.edit {
    background: linear-gradient(135deg, rgba(59,130,246,0.15), rgba(37,99,235,0.15));
    color: #3b82f6;
  }

  .btn-action.edit:hover {
    background: var(--info-gradient);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(59,130,246,0.3);
  }

  .btn-action.toggle {
    background: linear-gradient(135deg, rgba(245,158,11,0.15), rgba(217,119,6,0.15));
    color: #f59e0b;
  }

  .btn-action.toggle:hover {
    background: var(--warning-gradient);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(245,158,11,0.3);
  }

  .btn-action.view {
    background: linear-gradient(135deg, rgba(102,126,234,0.15), rgba(118,75,162,0.15));
    color: #667eea;
  }

  .btn-action.view:hover {
    background: var(--primary-gradient);
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(102,126,234,0.3);
  }

  /* Empty State */
  .empty-state {
    text-align: center;
    padding: 4rem 2rem;
  }

  .empty-icon {
    font-size: 4rem;
    color: #cbd5e1;
    margin-bottom: 1.5rem;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  .empty-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: #475569;
    margin-bottom: 0.5rem;
  }

  .empty-subtitle {
    color: #94a3b8;
    font-size: 1rem;
    margin-bottom: 1.5rem;
  }

  /* Animations */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animated {
    animation: fadeInUp 0.6s ease-out;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .deliverers-header {
      padding: 1.5rem;
    }

    .deliverers-header .d-flex {
      flex-direction: column !important;
      align-items: flex-start !important;
      gap: 1rem;
    }

    .deliverers-title {
      font-size: 1.5rem;
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }

    .btn-add-deliverer {
      width: 100%;
      justify-content: center;
    }

    .stats-grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .stat-card-deliverer {
      padding: 1.25rem;
    }

    .action-bar {
      flex-direction: column;
      gap: 1rem;
    }

    .search-wrapper {
      width: 100%;
    }

    .btn-search,
    .btn-add-deliverer {
      width: 100%;
      justify-content: center;
    }

    .filter-tabs {
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .filter-tab {
      padding: 0.5rem 1rem;
      font-size: 0.85rem;
    }

    /* Table responsive - scroll horizontal */
    .table-container {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      border-radius: var(--radius);
    }

    .table-ultra-premium {
      font-size: 0.875rem;
      min-width: 800px; /* Force minimum width for horizontal scroll */
    }

    .table-ultra-premium thead th,
    .table-ultra-premium tbody td {
      padding: 0.75rem 0.5rem;
      white-space: nowrap;
    }

    .deliverer-info h4 {
      font-size: 0.9rem;
    }

    .deliverer-info p {
      font-size: 0.75rem;
    }

    .deliverer-avatar {
      width: 40px;
      height: 40px;
    }

    .performance-bar {
      min-width: 80px;
    }

    .btn-action {
      padding: 0.4rem 0.6rem;
      font-size: 0.8rem;
    }
  }

  /* Responsive pour très petits écrans */
  @media (max-width: 480px) {
    .deliverers-header {
      padding: 1rem;
    }

    .deliverers-title {
      font-size: 1.25rem;
    }

    .deliverers-subtitle {
      font-size: 0.875rem;
    }

    .stat-value {
      font-size: 1.75rem;
    }

    .stat-label {
      font-size: 0.8rem;
    }

    .stat-change {
      font-size: 0.75rem;
    }

    .search-input {
      font-size: 0.875rem;
    }

    .filter-tab {
      padding: 0.4rem 0.75rem;
      font-size: 0.8rem;
    }
  }

  /* Landscape mobile */
  @media (max-width: 768px) and (orientation: landscape) {
    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

    .action-buttons {
      flex-direction: column;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid px-4 py-4">

  <!-- Header Ultra-Premium -->
  <div class="deliverers-header animated">
    <div class="d-flex justify-content-between align-items-center position-relative" style="z-index: 1;">
      <div>
        <h1 class="deliverers-title mb-2">
          <i class="bi bi-truck"></i>
          Gestion des Livreurs
        </h1>
        <p class="deliverers-subtitle mb-0">
          <i class="bi bi-people-fill me-2"></i>
          {{ deliverers|length }} livreur{{ deliverers|length|pluralize }} enregistré{{ deliverers|length|pluralize }}
        </p>
      </div>
      <a href="{% url 'admin_livreurs_create' %}" class="btn-add-deliverer">
        <i class="bi bi-plus-circle-fill"></i>
        Nouveau Livreur
      </a>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid animated" style="animation-delay: 0.1s;">
    <div class="stat-card-deliverer">
      <div class="stat-icon-wrapper primary">
        <i class="bi bi-truck"></i>
      </div>
      <div class="stat-label">Total Livreurs</div>
      <div class="stat-value" id="totalDeliverers">{{ stats.total_livreurs }}</div>
      <div class="stat-change positive">
        <i class="bi bi-people-fill"></i>
        Livreurs inscrits
      </div>
    </div>

    <div class="stat-card-deliverer">
      <div class="stat-icon-wrapper success">
        <i class="bi bi-check-circle-fill"></i>
      </div>
      <div class="stat-label">Livreurs Actifs</div>
      <div class="stat-value" id="activeDeliverers">{{ stats.active_livreurs }}</div>
      <div class="stat-change positive">
        <i class="bi bi-check-circle"></i>
        Disponibles
      </div>
    </div>

    <div class="stat-card-deliverer">
      <div class="stat-icon-wrapper warning">
        <i class="bi bi-box-seam"></i>
      </div>
      <div class="stat-label">Livraisons Mois</div>
      <div class="stat-value" id="monthDeliveries">{{ stats.monthly_deliveries }}</div>
      <div class="stat-change positive">
        <i class="bi bi-calendar-month"></i>
        30 derniers jours
      </div>
    </div>

    <div class="stat-card-deliverer">
      <div class="stat-icon-wrapper danger">
        <i class="bi bi-star-fill"></i>
      </div>
      <div class="stat-label">Note Moyenne</div>
      <div class="stat-value" id="avgRating">4.8/5</div>
      <div class="stat-change positive">
        <i class="bi bi-arrow-up-short"></i>
        Excellent
      </div>
    </div>
  </div>

  <!-- Action Bar -->
  <div class="action-bar animated" style="animation-delay: 0.2s;">
    <form method="get" class="search-wrapper">
      <i class="bi bi-search search-icon"></i>
      <input type="text" 
             name="q" 
             value="{{ q|default:'' }}" 
             class="search-input-ultra" 
             placeholder="🔍 Rechercher par nom, username, téléphone...">
    </form>
    <button class="btn-search" type="submit" onclick="this.closest('form').submit()">
      <i class="bi bi-search"></i>
      Rechercher
    </button>
  </div>

  <!-- Table Card -->
  <div class="table-card animated" style="animation-delay: 0.3s;">
    <div class="table-header">
      <h5>
        <i class="bi bi-table"></i>
        Liste Complète des Livreurs
        <span style="background: linear-gradient(135deg, rgba(102,126,234,0.15), rgba(118,75,162,0.15)); 
                     color: #667eea; 
                     padding: 0.25rem 0.75rem; 
                     border-radius: 0.5rem; 
                     font-size: 0.875rem; 
                     font-weight: 700;
                     margin-left: 0.75rem;">
          {{ deliverers|length }}
        </span>
      </h5>
      <div style="color: #94a3b8; font-size: 0.875rem;">
        <i class="bi bi-calendar3 me-1"></i>
        Mise à jour : {% now "d/m/Y H:i" %}
      </div>
    </div>
    
    <div class="table-responsive">
      <table class="table-ultra-premium">
        <thead>
          <tr>
            <th>ID</th>
            <th>Livreur</th>
            <th>Contact</th>
            <th>Statut</th>
            <th>Performance</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>
        <tbody>
          {% if deliverers %}
            {% for d in deliverers %}
              <tr>
                <td>
                  <span style="font-weight: 700; color: #667eea; font-size: 1.1rem;">
                    #{{ d.profile.user.id }}
                  </span>
                </td>
                
                <td>
                  <div class="deliverer-info">
                    {% if d.profile.photo %}
                      <img src="{{ d.profile.photo.url }}" 
                           alt="{{ d.profile.user.username }}" 
                           class="deliverer-avatar">
                    {% else %}
                      <img src="https://ui-avatars.com/api/?name={{ d.profile.user.get_full_name|default:d.profile.user.username|urlencode }}&background=667eea&color=fff&size=128&font-size=0.4&bold=true" 
                           alt="{{ d.profile.user.username }}" 
                           class="deliverer-avatar">
                    {% endif %}
                    <div class="deliverer-details">
                      <span class="deliverer-name">{{ d.profile.user.get_full_name|default:d.profile.user.username }}</span>
                      <span class="deliverer-username">@{{ d.profile.user.username }}</span>
                    </div>
                  </div>
                </td>
                
                <td>
                  <div class="contact-info">
                    {% if d.profile.phone %}
                      <a href="tel:{{ d.profile.phone }}" class="contact-badge phone">
                        <i class="bi bi-telephone-fill"></i>
                        {{ d.profile.phone }}
                      </a>
                    {% else %}
                      <span style="color: #94a3b8; font-size: 0.875rem;">Aucun téléphone</span>
                    {% endif %}
                    
                    {% if d.profile.user.email %}
                      <a href="mailto:{{ d.profile.user.email }}" class="contact-badge">
                        <i class="bi bi-envelope-fill"></i>
                        {{ d.profile.user.email }}
                      </a>
                    {% else %}
                      <span style="color: #94a3b8; font-size: 0.875rem;">Aucun email</span>
                    {% endif %}
                  </div>
                </td>
                
                <td>
                  {% if d.profile.user.is_active %}
                    <span class="status-badge-ultra active">
                      <i class="bi bi-check-circle-fill"></i>
                      Actif
                    </span>
                  {% else %}
                    <span class="status-badge-ultra inactive">
                      <i class="bi bi-x-circle-fill"></i>
                      Inactif
                    </span>
                  {% endif %}
                </td>
                
                <td>
                  <div class="performance-badge">
                    <i class="bi bi-star-fill"></i>
                    {{ d.avg_rating|floatformat:1|default:"0.0" }}/5
                  </div>
                  <div style="color: #94a3b8; font-size: 0.8rem; margin-top: 0.5rem;">
                    <i class="bi bi-box-seam me-1"></i>
                    {{ d.total_deliveries }} livraison{{ d.total_deliveries|pluralize }}
                  </div>
                  {% if d.ongoing_deliveries > 0 %}
                  <div style="color: #f59e0b; font-size: 0.75rem; margin-top: 0.25rem;">
                    <i class="bi bi-truck me-1"></i>
                    {{ d.ongoing_deliveries }} en cours
                  </div>
                  {% endif %}
                </td>
                
                <td>
                  <div class="action-buttons justify-content-center">
                    <a href="#" 
                       class="btn-action view" 
                       title="Voir les détails"
                       onclick="viewDeliverer({{ d.profile.user.id }}); return false;">
                      <i class="bi bi-eye-fill"></i>
                    </a>
                    
                    <a href="{% url 'admin_livreurs_edit' d.profile.user.id %}" 
                       class="btn-action edit" 
                       title="Modifier">
                      <i class="bi bi-pencil-fill"></i>
                    </a>
                    
                    <a href="{% url 'admin_livreurs_toggle_active' d.profile.user.id %}" 
                       class="btn-action toggle" 
                       title="{% if d.profile.user.is_active %}Désactiver{% else %}Activer{% endif %}"
                       onclick="return confirm('Voulez-vous {% if d.profile.user.is_active %}désactiver{% else %}activer{% endif %} ce livreur ?')">
                      <i class="bi bi-{% if d.profile.user.is_active %}ban{% else %}check-circle{% endif %}"></i>
                    </a>
                  </div>
                </td>
              </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="6" class="empty-state">
                <div class="empty-icon">
                  {% if q %}
                    <i class="bi bi-search"></i>
                  {% else %}
                    <i class="bi bi-truck"></i>
                  {% endif %}
                </div>
                <div class="empty-title">
                  {% if q %}
                    Aucun résultat trouvé
                  {% else %}
                    Aucun livreur enregistré
                  {% endif %}
                </div>
                <div class="empty-subtitle">
                  {% if q %}
                    Essayez avec d'autres mots-clés : "{{ q }}"
                  {% else %}
                    Commencez par ajouter votre premier livreur
                  {% endif %}
                </div>
                <a href="{% url 'admin_livreurs_create' %}" class="btn-add-deliverer">
                  <i class="bi bi-plus-circle-fill"></i>
                  Ajouter un Livreur
                </a>
              </td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>

</div>

{% endblock %}

{% block extra_js %}
<script>
  // Count up animation for stats
  function animateValue(id, start, end, duration) {
    const obj = document.getElementById(id);
    if (!obj) return;
    
    const range = end - start;
    let current = start;
    const increment = end > start ? 1 : -1;
    const stepTime = Math.abs(Math.floor(duration / range));
    
    const timer = setInterval(() => {
      current += increment;
      obj.textContent = current;
      if (current === end) {
        clearInterval(timer);
      }
    }, stepTime);
  }

  // Initialize animations on page load
  window.addEventListener('DOMContentLoaded', () => {
    const totalDeliverers = {{ deliverers|length }};
    const activeDeliverers = {% for d in deliverers %}{% if d.user.is_active %}1{% endif %}{% endfor %} || 0;
    const monthDeliveries = totalDeliverers + 25;
    
    setTimeout(() => {
      animateValue('totalDeliverers', 0, totalDeliverers, 1000);
      animateValue('activeDeliverers', 0, activeDeliverers, 1000);
      animateValue('monthDeliveries', 0, monthDeliveries, 1000);
    }, 300);
  });

  // View deliverer details
  function viewDeliverer(id) {
    showNotification('Affichage des détails du livreur...', 'info');
    setTimeout(() => {
      // Redirection vers la page de détails (à créer si nécessaire)
      window.location.href = `/admin-panel/deliverers/${id}/`;
    }, 500);
  }

  // Notification system
  function showNotification(message, type = 'success') {
    const colors = {
      success: 'linear-gradient(135deg, #10b981, #059669)',
      error: 'linear-gradient(135deg, #ef4444, #dc2626)',
      info: 'linear-gradient(135deg, #3b82f6, #2563eb)',
      warning: 'linear-gradient(135deg, #f59e0b, #d97706)'
    };

    const icons = {
      success: 'check-circle-fill',
      error: 'x-circle-fill',
      info: 'info-circle-fill',
      warning: 'exclamation-triangle-fill'
    };

    const notification = document.createElement('div');
    notification.style.cssText = `
      position: fixed;
      top: 2rem;
      right: 2rem;
      background: ${colors[type]};
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 0.75rem;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      z-index: 99999;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 600;
      animation: slideInRight 0.3s ease-out;
    `;
    
    notification.innerHTML = `
      <i class="bi bi-${icons[type]}" style="font-size: 1.25rem;"></i>
      ${message}
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOutRight 0.3s ease-out';
      setTimeout(() => notification.remove(), 300);
    }, 3000);
  }

  // Search input focus effect
  document.querySelector('.search-input-ultra')?.addEventListener('focus', function() {
    this.parentElement.style.transform = 'scale(1.02)';
  });

  document.querySelector('.search-input-ultra')?.addEventListener('blur', function() {
    this.parentElement.style.transform = 'scale(1)';
  });
</script>

<style>
  @keyframes slideInRight {
    from {
      transform: translateX(400px);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes slideOutRight {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(400px);
      opacity: 0;
    }
  }
</style>
{% endblock %}